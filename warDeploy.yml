---
- hosts: tomcatServer
  become: yes
  vars:
  - warLocalPath: {{ warNameFilePath }}
  - warRemotePath: /opt/apache-tomcat-9.0.16/webapps

  tasks:
  - name: Download WAR to server
    synchronize: src={{ warLocalPath }} dest={{ warRemotePath }}/SprintApp.war

  - name: Unzip WAR file
    unarchive: src={{ warRemotePath }}/SprintApp.war dest=/opt/apache-tomcat-9.0.16/webapps copy=no mode=0755 owner=tomcat group=tomcat
    notify:
        - Restart tomcat

  - name: Delete remote war file
    file: path={{ warRemotePath }}/SprintApp.war state=absent

  handlers:
    - name: Restart tomcat
      service: name=tomcat state=restarted
